{"version":3,"file":"p5.recorder.js","sources":["../node_modules/downloadjs/download.js","../src/p5.recorder.js"],"sourcesContent":["//download.js v4.2, by dandavis; 2008-2016. [MIT] see http://danml.com/download.html for tests/usage\n// v1 landed a FF+Chrome compat way of downloading strings to local un-named files, upgraded to use a hidden frame and optional mime\n// v2 added named files via a[download], msSaveBlob, IE (10+) support, and window.URL support for larger+faster saves than dataURLs\n// v3 added dataURL and Blob Input, bind-toggle arity, and legacy dataURL fallback was improved with force-download mime and base64 support. 3.1 improved safari handling.\n// v4 adds AMD/UMD, commonJS, and plain browser support\n// v4.1 adds url download capability via solo URL argument (same domain/CORS only)\n// v4.2 adds semantic variable names, long (over 2MB) dataURL support, and hidden by default temp anchors\n// https://github.com/rndme/download\n\n(function (root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine([], factory);\n\t} else if (typeof exports === 'object') {\n\t\t// Node. Does not work with strict CommonJS, but\n\t\t// only CommonJS-like environments that support module.exports,\n\t\t// like Node.\n\t\tmodule.exports = factory();\n\t} else {\n\t\t// Browser globals (root is window)\n\t\troot.download = factory();\n  }\n}(this, function () {\n\n\treturn function download(data, strFileName, strMimeType) {\n\n\t\tvar self = window, // this script is only for browsers anyway...\n\t\t\tdefaultMime = \"application/octet-stream\", // this default mime also triggers iframe downloads\n\t\t\tmimeType = strMimeType || defaultMime,\n\t\t\tpayload = data,\n\t\t\turl = !strFileName && !strMimeType && payload,\n\t\t\tanchor = document.createElement(\"a\"),\n\t\t\ttoString = function(a){return String(a);},\n\t\t\tmyBlob = (self.Blob || self.MozBlob || self.WebKitBlob || toString),\n\t\t\tfileName = strFileName || \"download\",\n\t\t\tblob,\n\t\t\treader;\n\t\t\tmyBlob= myBlob.call ? myBlob.bind(self) : Blob ;\n\t  \n\t\tif(String(this)===\"true\"){ //reverse arguments, allowing download.bind(true, \"text/xml\", \"export.xml\") to act as a callback\n\t\t\tpayload=[payload, mimeType];\n\t\t\tmimeType=payload[0];\n\t\t\tpayload=payload[1];\n\t\t}\n\n\n\t\tif(url && url.length< 2048){ // if no filename and no mime, assume a url was passed as the only argument\n\t\t\tfileName = url.split(\"/\").pop().split(\"?\")[0];\n\t\t\tanchor.href = url; // assign href prop to temp anchor\n\t\t  \tif(anchor.href.indexOf(url) !== -1){ // if the browser determines that it's a potentially valid url path:\n        \t\tvar ajax=new XMLHttpRequest();\n        \t\tajax.open( \"GET\", url, true);\n        \t\tajax.responseType = 'blob';\n        \t\tajax.onload= function(e){ \n\t\t\t\t  download(e.target.response, fileName, defaultMime);\n\t\t\t\t};\n        \t\tsetTimeout(function(){ ajax.send();}, 0); // allows setting custom ajax headers using the return:\n\t\t\t    return ajax;\n\t\t\t} // end if valid url?\n\t\t} // end if url?\n\n\n\t\t//go ahead and download dataURLs right away\n\t\tif(/^data:([\\w+-]+\\/[\\w+.-]+)?[,;]/.test(payload)){\n\t\t\n\t\t\tif(payload.length > (1024*1024*1.999) && myBlob !== toString ){\n\t\t\t\tpayload=dataUrlToBlob(payload);\n\t\t\t\tmimeType=payload.type || defaultMime;\n\t\t\t}else{\t\t\t\n\t\t\t\treturn navigator.msSaveBlob ?  // IE10 can't do a[download], only Blobs:\n\t\t\t\t\tnavigator.msSaveBlob(dataUrlToBlob(payload), fileName) :\n\t\t\t\t\tsaver(payload) ; // everyone else can save dataURLs un-processed\n\t\t\t}\n\t\t\t\n\t\t}else{//not data url, is it a string with special needs?\n\t\t\tif(/([\\x80-\\xff])/.test(payload)){\t\t\t  \n\t\t\t\tvar i=0, tempUiArr= new Uint8Array(payload.length), mx=tempUiArr.length;\n\t\t\t\tfor(i;i<mx;++i) tempUiArr[i]= payload.charCodeAt(i);\n\t\t\t \tpayload=new myBlob([tempUiArr], {type: mimeType});\n\t\t\t}\t\t  \n\t\t}\n\t\tblob = payload instanceof myBlob ?\n\t\t\tpayload :\n\t\t\tnew myBlob([payload], {type: mimeType}) ;\n\n\n\t\tfunction dataUrlToBlob(strUrl) {\n\t\t\tvar parts= strUrl.split(/[:;,]/),\n\t\t\ttype= parts[1],\n\t\t\tdecoder= parts[2] == \"base64\" ? atob : decodeURIComponent,\n\t\t\tbinData= decoder( parts.pop() ),\n\t\t\tmx= binData.length,\n\t\t\ti= 0,\n\t\t\tuiArr= new Uint8Array(mx);\n\n\t\t\tfor(i;i<mx;++i) uiArr[i]= binData.charCodeAt(i);\n\n\t\t\treturn new myBlob([uiArr], {type: type});\n\t\t }\n\n\t\tfunction saver(url, winMode){\n\n\t\t\tif ('download' in anchor) { //html5 A[download]\n\t\t\t\tanchor.href = url;\n\t\t\t\tanchor.setAttribute(\"download\", fileName);\n\t\t\t\tanchor.className = \"download-js-link\";\n\t\t\t\tanchor.innerHTML = \"downloading...\";\n\t\t\t\tanchor.style.display = \"none\";\n\t\t\t\tdocument.body.appendChild(anchor);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tanchor.click();\n\t\t\t\t\tdocument.body.removeChild(anchor);\n\t\t\t\t\tif(winMode===true){setTimeout(function(){ self.URL.revokeObjectURL(anchor.href);}, 250 );}\n\t\t\t\t}, 66);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// handle non-a[download] safari as best we can:\n\t\t\tif(/(Version)\\/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari\\//.test(navigator.userAgent)) {\n\t\t\t\tif(/^data:/.test(url))\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t\tif(!window.open(url)){ // popup blocked, offer direct download:\n\t\t\t\t\tif(confirm(\"Displaying New Document\\n\\nUse Save As... to download, then click back to return to this page.\")){ location.href=url; }\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t//do iframe dataURL download (old ch+FF):\n\t\t\tvar f = document.createElement(\"iframe\");\n\t\t\tdocument.body.appendChild(f);\n\n\t\t\tif(!winMode && /^data:/.test(url)){ // force a mime that will download:\n\t\t\t\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t}\n\t\t\tf.src=url;\n\t\t\tsetTimeout(function(){ document.body.removeChild(f); }, 333);\n\n\t\t}//end saver\n\n\n\n\n\t\tif (navigator.msSaveBlob) { // IE10+ : (has Blob, but not a[download] or URL)\n\t\t\treturn navigator.msSaveBlob(blob, fileName);\n\t\t}\n\n\t\tif(self.URL){ // simple fast and modern way using Blob and URL:\n\t\t\tsaver(self.URL.createObjectURL(blob), true);\n\t\t}else{\n\t\t\t// handle non-Blob()+non-URL browsers:\n\t\t\tif(typeof blob === \"string\" || blob.constructor===toString ){\n\t\t\t\ttry{\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \";base64,\"  +  self.btoa(blob)  );\n\t\t\t\t}catch(y){\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \",\" + encodeURIComponent(blob)  );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Blob but not URL support:\n\t\t\treader=new FileReader();\n\t\t\treader.onload=function(e){\n\t\t\t\tsaver(this.result);\n\t\t\t};\n\t\t\treader.readAsDataURL(blob);\n\t\t}\n\t\treturn true;\n\t}; /* end download() */\n}));\n","const downloadjs = require(\"downloadjs\");\r\n\r\nexport default class Recorder {\r\n  #chunks = [];\r\n  #recorder;\r\n  #saveAfterStop = true;\r\n  #audioStreamTab;\r\n  #defaultRecordingOptions = {\r\n    filename: \"p5.recorder.canvas.webm\",\r\n    recordAudio: true,\r\n    audioBitRate: 128000,\r\n    videoBitRate: 120000000,\r\n    fps: 60,\r\n  };\r\n  #currentRecordingOptions = {\r\n    canvas: undefined,\r\n    filename: undefined,\r\n    recordAudio: undefined,\r\n    audioBitRate: undefined,\r\n    videoBitRate: undefined,\r\n    fps: undefined,\r\n    mimeType: undefined,\r\n  };\r\n  #timer = {\r\n    start: undefined,\r\n    end: undefined,\r\n  };\r\n  #progress = 0;\r\n\r\n  constructor(saveAfterStop = true) {\r\n    this.#saveAfterStop = saveAfterStop;\r\n  }\r\n\r\n  get #currentBlob() {\r\n    return new Blob(this.#chunks);\r\n  }\r\n\r\n  async start(options) {\r\n    this.#mergeUserOptions(options);\r\n    let stream = await this.#resolveStream();\r\n    this.#createRecorder(stream);\r\n    this.#recorder.start();\r\n  }\r\n\r\n  #mergeUserOptions(userOptions) {\r\n    this.#currentRecordingOptions = {\r\n      canvas: document.querySelector(\"canvas\"),\r\n      ...this.#defaultRecordingOptions,\r\n      ...userOptions,\r\n      mimeType: \"video/webm\",\r\n    };\r\n  }\r\n\r\n  async #resolveStream() {\r\n    let tracks = [];\r\n    const { canvas, fps, recordAudio } = this.#currentRecordingOptions;\r\n    //video track from canvas stream\r\n    let videoStream = canvas.captureStream(fps);\r\n    tracks.push(videoStream.getVideoTracks()[0]);\r\n\r\n    /**\r\n     * tracking here https://github.com/processing/p5.js-sound/issues/457\r\n     * the possibility to not use navigator.mediaDevices.getDisplayMedia API\r\n     */\r\n    if (recordAudio) {\r\n      //seems we can record using the same stream after user click for stop sharing.\r\n      if (!this.#audioStreamTab || !this.#audioStreamTab.active)\r\n        this.#audioStreamTab = await navigator.mediaDevices.getDisplayMedia({\r\n          audio: true,\r\n          video: true,\r\n        });\r\n      let audioTracks = this.#audioStreamTab.getAudioTracks();\r\n      audioTracks.forEach((track) => tracks.push(track));\r\n    }\r\n\r\n    //combine video and audiotracks\r\n    let combinedStream = new MediaStream(tracks);\r\n    return combinedStream;\r\n  }\r\n\r\n  #createRecorder(stream) {\r\n    this.#recorder = new MediaRecorder(stream, this.currentRecordingOptions);\r\n    this.#recorder.onstop = this.#onMediaRecorderStop.bind(this);\r\n    this.#recorder.onstart = this.#onMediaRecorderStart.bind(this);\r\n    this.#recorder.ondataavailable = this.#onDataAvailable.bind(this);\r\n    this.#recorder.onstop = this.#onMediaRecorderStop.bind(this);\r\n    this.#recorder.onerror = (e) => console.log(e);\r\n    return this.#recorder;\r\n  }\r\n\r\n  #onDataAvailable(e) {\r\n    if (e.data.size) {\r\n      this.#chunks.push(e.data);\r\n    }\r\n  }\r\n\r\n  #onMediaRecorderStart() {\r\n    this.#timer = {\r\n      start: new Date(),\r\n      end: undefined,\r\n    };\r\n    this.#progress = 0;\r\n    this.#chunks = [];\r\n    this.#chunks.length = 0;\r\n  }\r\n\r\n  #onMediaRecorderStop() {\r\n    this.#timer.end = new Date();\r\n    this.#progress = 100;\r\n    if (this.#saveAfterStop) this.download();\r\n  }\r\n\r\n  download() {\r\n    downloadjs(\r\n      this.#currentBlob,\r\n      this.#currentRecordingOptions.filename,\r\n      this.#currentRecordingOptions.mimeType\r\n    );\r\n  }\r\n\r\n  stop() {\r\n    this.#recorder.stop();\r\n  }\r\n\r\n  get #webMRecordedTime() {\r\n    let date = this.#timer?.end?.getTime() || new Date().getTime();\r\n    return date - this.#timer?.start?.getTime() || undefined;\r\n  }\r\n\r\n  get #webMtotalRecordedFrames() {\r\n    return (this.#webMRecordedTime * this.#currentRecordingOptions.fps) / 1000 || 0;\r\n  }\r\n\r\n  /**\r\n   * we can play with transcoding state, mixing mediaRecoder + transcoding when user ask for transcoding\r\n   * makes more sense use the progress to transcoding only\r\n   *\r\n   * contains current status\r\n   * status: {\r\n   *   frames: 0,\r\n   *   progress: 0,\r\n   *   state: undefined,\r\n   *   time: undefined,\r\n   * }\r\n   */\r\n  get status() {\r\n    return {\r\n      state: this.#recorder?.state,\r\n      time: this.#webMRecordedTime,\r\n      frames: this.#webMtotalRecordedFrames,\r\n      progress: this.#progress,\r\n    };\r\n  }\r\n}\r\n"],"names":["this","Recorder","constructor","saveAfterStop","filename","recordAudio","audioBitRate","videoBitRate","fps","canvas","undefined","mimeType","start","end","options","stream","download","downloadjs","stop","status","state","time","frames","progress","Blob","userOptions","document","querySelector","tracks","videoStream","captureStream","push","getVideoTracks","active","navigator","mediaDevices","getDisplayMedia","audio","video","audioTracks","getAudioTracks","forEach","track","combinedStream","MediaStream","MediaRecorder","currentRecordingOptions","onstop","bind","onstart","ondataavailable","onerror","e","console","log","data","size","Date","length","date","getTime"],"mappings":";;;;;;;;;;;;;;;;;;;;CASA,CAAC,UAAU,IAAI,EAAE,OAAO,EAAE;CAC1B,CAGyC;CAIzC,EAAE,cAAc,GAAG,OAAO,EAAE,CAAC;CAC7B,EAGG;CACH,CAAC,CAACA,cAAI,EAAE,YAAY;CAEpB,CAAC,OAAO,SAAS,QAAQ,CAAC,IAAI,EAAE,WAAW,EAAE,WAAW,EAAE;CAE1D,EAAE,IAAI,IAAI,GAAG,MAAM;CACnB,GAAG,WAAW,GAAG,0BAA0B;CAC3C,GAAG,QAAQ,GAAG,WAAW,IAAI,WAAW;CACxC,GAAG,OAAO,GAAG,IAAI;CACjB,GAAG,GAAG,GAAG,CAAC,WAAW,IAAI,CAAC,WAAW,IAAI,OAAO;CAChD,GAAG,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC;CACvC,GAAG,QAAQ,GAAG,SAAS,CAAC,CAAC,CAAC,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;CAC5C,GAAG,MAAM,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,UAAU,IAAI,QAAQ,CAAC;CACtE,GAAG,QAAQ,GAAG,WAAW,IAAI,UAAU;CACvC,GAAG,IAAI;CACP,GAAG,MAAM,CAAC;CACV,GAAG,MAAM,EAAE,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,EAAE;CAEnD,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;CAC3B,GAAG,OAAO,CAAC,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;CAC/B,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;CACvB,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;CACtB,GAAG;CAGH,EAAE,GAAG,GAAG,IAAI,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC;CAC7B,GAAG,QAAQ,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;CACjD,GAAG,MAAM,CAAC,IAAI,GAAG,GAAG,CAAC;CACrB,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;CACxC,UAAU,IAAI,IAAI,CAAC,IAAI,cAAc,EAAE,CAAC;CACxC,UAAU,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;CACvC,UAAU,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC;CACrC,UAAU,IAAI,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;CAClC,MAAM,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,QAAQ,EAAE,WAAW,CAAC,CAAC;CACzD,KAAK,CAAC;CACN,UAAU,UAAU,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;CACnD,OAAO,OAAO,IAAI,CAAC;CACnB,IAAI;CACJ,GAAG;CAIH,EAAE,GAAG,gCAAgC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;CAEpD,GAAG,GAAG,OAAO,CAAC,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,MAAM,KAAK,QAAQ,EAAE;CACjE,IAAI,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;CACnC,IAAI,QAAQ,CAAC,OAAO,CAAC,IAAI,IAAI,WAAW,CAAC;CACzC,IAAI,KAAI;CACR,IAAI,OAAO,SAAS,CAAC,UAAU;CAC/B,KAAK,SAAS,CAAC,UAAU,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE,QAAQ,CAAC;CAC3D,KAAK,KAAK,CAAC,OAAO,CAAC,EAAE;CACrB,IAAI;CAEJ,GAAG,KAAI;CACP,GAAG,GAAG,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;CACpC,IAAI,IAAI,CAAC,CAAC,CAAC,EAAE,SAAS,EAAE,IAAI,UAAU,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC;CAC5E,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;CACxD,KAAK,OAAO,CAAC,IAAI,MAAM,CAAC,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,CAAC;CACvD,IAAI;CACJ,GAAG;CACH,EAAE,IAAI,GAAG,OAAO,YAAY,MAAM;CAClC,GAAG,OAAO;CACV,GAAG,IAAI,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,EAAE;CAG5C,EAAE,SAAS,aAAa,CAAC,MAAM,EAAE;CACjC,GAAG,IAAI,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;CACnC,GAAG,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC;CACjB,GAAG,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,IAAI,QAAQ,GAAG,IAAI,GAAG,kBAAkB;CAC5D,GAAG,OAAO,EAAE,OAAO,EAAE,KAAK,CAAC,GAAG,EAAE,EAAE;CAClC,GAAG,EAAE,EAAE,OAAO,CAAC,MAAM;CACrB,GAAG,CAAC,EAAE,CAAC;CACP,GAAG,KAAK,EAAE,IAAI,UAAU,CAAC,EAAE,CAAC,CAAC;CAE7B,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;CAEnD,GAAG,OAAO,IAAI,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;CAC5C,IAAI;CAEJ,EAAE,SAAS,KAAK,CAAC,GAAG,EAAE,OAAO,CAAC;CAE9B,GAAG,IAAI,UAAU,IAAI,MAAM,EAAE;CAC7B,IAAI,MAAM,CAAC,IAAI,GAAG,GAAG,CAAC;CACtB,IAAI,MAAM,CAAC,YAAY,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;CAC9C,IAAI,MAAM,CAAC,SAAS,GAAG,kBAAkB,CAAC;CAC1C,IAAI,MAAM,CAAC,SAAS,GAAG,gBAAgB,CAAC;CACxC,IAAI,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;CAClC,IAAI,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;CACtC,IAAI,UAAU,CAAC,WAAW;CAC1B,KAAK,MAAM,CAAC,KAAK,EAAE,CAAC;CACpB,KAAK,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;CACvC,KAAK,GAAG,OAAO,GAAG,IAAI,CAAC,CAAC,UAAU,CAAC,UAAU,EAAE,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;CAC/F,KAAK,EAAE,EAAE,CAAC,CAAC;CACX,IAAI,OAAO,IAAI,CAAC;CAChB,IAAI;CAGJ,GAAG,GAAG,+CAA+C,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE;CACjF,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,qBAAqB,EAAE,WAAW,CAAC,CAAC;CACvF,IAAI,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;CACzB,KAAK,GAAG,OAAO,CAAC,gGAAgG,CAAC,CAAC,EAAE,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;CACxI,KAAK;CACL,IAAI,OAAO,IAAI,CAAC;CAChB,IAAI;CAGJ,GAAG,IAAI,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;CAC5C,GAAG,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;CAEhC,GAAG,GAAG,CAAC,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;CACrC,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,qBAAqB,EAAE,WAAW,CAAC,CAAC;CAChE,IAAI;CACJ,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC;CACb,GAAG,UAAU,CAAC,UAAU,EAAE,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;CAEhE,GAAG;CAKH,EAAE,IAAI,SAAS,CAAC,UAAU,EAAE;CAC5B,GAAG,OAAO,SAAS,CAAC,UAAU,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;CAC/C,GAAG;CAEH,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;CACd,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;CAC/C,GAAG,KAAI;CAEP,GAAG,GAAG,OAAO,IAAI,KAAK,QAAQ,IAAI,IAAI,CAAC,WAAW,GAAG,QAAQ,EAAE;CAC/D,IAAI,GAAG;CACP,KAAK,OAAO,KAAK,EAAE,OAAO,IAAI,QAAQ,KAAK,UAAU,KAAK,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;CAC7E,KAAK,MAAM,CAAC,CAAC;CACb,KAAK,OAAO,KAAK,EAAE,OAAO,IAAI,QAAQ,KAAK,GAAG,GAAG,kBAAkB,CAAC,IAAI,CAAC,GAAG,CAAC;CAC7E,KAAK;CACL,IAAI;CAGJ,GAAG,MAAM,CAAC,IAAI,UAAU,EAAE,CAAC;CAC3B,GAAG,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;CAC5B,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;CACvB,IAAI,CAAC;CACL,GAAG,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;CAC9B,GAAG;CACH,EAAE,OAAO,IAAI,CAAC;CACd,EAAE,CAAC;CACH,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CCpKa,MAAMC,QAAN,CAAe;CA2B5BC,EAAAA,WAAW,GAAuB;CAAA,QAAtBC,aAAsB,uEAAN,IAAM;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA,aA1BxB;CA0BwB;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA,aAxBjB;CAwBiB;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA,aAtBP;CACzBC,QAAAA,QAAQ,EAAE,yBADe;CAEzBC,QAAAA,WAAW,EAAE,IAFY;CAGzBC,QAAAA,YAAY,EAAE,MAHW;CAIzBC,QAAAA,YAAY,EAAE,SAJW;CAKzBC,QAAAA,GAAG,EAAE;CALoB;CAsBO;CAAA;CAAA;CAAA,aAfP;CACzBC,QAAAA,MAAM,EAAEC,SADiB;CAEzBN,QAAAA,QAAQ,EAAEM,SAFe;CAGzBL,QAAAA,WAAW,EAAEK,SAHY;CAIzBJ,QAAAA,YAAY,EAAEI,SAJW;CAKzBH,QAAAA,YAAY,EAAEG,SALW;CAMzBF,QAAAA,GAAG,EAAEE,SANoB;CAOzBC,QAAAA,QAAQ,EAAED;CAPe;CAeO;CAAA;CAAA;CAAA,aANzB;CACPE,QAAAA,KAAK,EAAEF,SADA;CAEPG,QAAAA,GAAG,EAAEH;CAFE;CAMyB;CAAA;CAAA;CAAA,aAFtB;CAEsB;CAChC,gDAAsBP,aAAtB;CACD;CAMKS,EAAAA,KAAN,CAAYE,OAAZ,EAAqB;CAAA;CAAA;CACnB,6BAAA,KAAI,wCAAJ,MAAA,KAAI,EAAmBA,OAAnB,CAAJ;CACA,UAAIC,MAAM,gCAAS,KAAT,wCAAS,KAAT,CAAV;CACA,6BAAA,KAAI,oCAAJ,MAAA,KAAI,EAAiBA,MAAjB,CAAJ;CACA,4BAAA,KAAI,YAAJ,CAAeH,KAAf;CAJmB;CAKpB;CAsEDI,EAAAA,QAAQ,GAAG;CACTC,IAAAA,QAAU,uBACR,IADQ,iBAER,sDAA8Bb,QAFtB,EAGR,sDAA8BO,QAHtB,CAAV;CAKD;CAEDO,EAAAA,IAAI,GAAG;CACL,2CAAeA,IAAf;CACD;CAuBD,MAAIC,MAAJ,GAAa;CAAA;CACX,WAAO;CACLC,MAAAA,KAAK,kDAAE,IAAF,uEAAE,uBAAgBA,KADlB;CAELC,MAAAA,IAAI,wBAAE,IAAF,oBAFC;CAGLC,MAAAA,MAAM,wBAAE,IAAF,2BAHD;CAILC,MAAAA,QAAQ,wBAAE,IAAF;CAJH,KAAP;CAMD;CAtJ2B;;;;;;;;;;;;;;;;;;oDA+BT;CACjB,SAAO,IAAIC,IAAJ,uBAAS,IAAT,WAAP;CACD;sDASiBC,aAAa;CAC7B;CACEhB,IAAAA,MAAM,EAAEiB,QAAQ,CAACC,aAAT,CAAuB,QAAvB;CADV,2BAEK,IAFL,iCAGKF,WAHL;CAIEd,IAAAA,QAAQ,EAAE;CAJZ;CAMD;;wDAEsB;CACrB,QAAIiB,MAAM,GAAG,EAAb;CACA,QAAM;CAAEnB,MAAAA,MAAF;CAAUD,MAAAA,GAAV;CAAeH,MAAAA;CAAf,8BAA+B,IAA/B,2BAAN,CAFqB;CAIrB,QAAIwB,WAAW,GAAGpB,MAAM,CAACqB,aAAP,CAAqBtB,GAArB,CAAlB;CACAoB,IAAAA,MAAM,CAACG,IAAP,CAAYF,WAAW,CAACG,cAAZ,GAA6B,CAA7B,CAAZ;CAMA,QAAI3B,WAAJ,EAAiB;CAEf,UAAI,uBAAC,IAAD,sBAAyB,CAAC,6CAAqB4B,MAAnD,EACE,oDAA6BC,SAAS,CAACC,YAAV,CAAuBC,eAAvB,CAAuC;CAClEC,QAAAA,KAAK,EAAE,IAD2D;CAElEC,QAAAA,KAAK,EAAE;CAF2D,OAAvC,CAA7B;CAIF,UAAIC,WAAW,GAAG,6CAAqBC,cAArB,EAAlB;CACAD,MAAAA,WAAW,CAACE,OAAZ,CAAqBC,KAAD,IAAWd,MAAM,CAACG,IAAP,CAAYW,KAAZ,CAA/B;CACD,KApBoB;CAuBrB,QAAIC,cAAc,GAAG,IAAIC,WAAJ,CAAgBhB,MAAhB,CAArB;CACA,WAAOe,cAAP;CACD;;;;;;kDAEe5B,QAAQ;CACtB,yCAAiB,IAAI8B,aAAJ,CAAkB9B,MAAlB,EAA0B,KAAK+B,uBAA/B,CAAjB;CACA,yCAAeC,MAAf,GAAwB,0EAA0BC,IAA1B,CAA+B,IAA/B,CAAxB;CACA,yCAAeC,OAAf,GAAyB,4EAA2BD,IAA3B,CAAgC,IAAhC,CAAzB;CACA,yCAAeE,eAAf,GAAiC,kEAAsBF,IAAtB,CAA2B,IAA3B,CAAjC;CACA,yCAAeD,MAAf,GAAwB,0EAA0BC,IAA1B,CAA+B,IAA/B,CAAxB;CACA,yCAAeG,OAAf,GAA0BC,CAAD,IAAOC,OAAO,CAACC,GAAR,CAAYF,CAAZ,CAAhC;CACA,+BAAO,IAAP;CACD;oDAEgBA,GAAG;CAClB,MAAIA,CAAC,CAACG,IAAF,CAAOC,IAAX,EAAiB;CACf,yCAAazB,IAAb,CAAkBqB,CAAC,CAACG,IAApB;CACD;CACF;gEAEuB;CACtB,sCAAc;CACZ3C,IAAAA,KAAK,EAAE,IAAI6C,IAAJ,EADK;CAEZ5C,IAAAA,GAAG,EAAEH;CAFO,GAAd;CAIA,yCAAiB,CAAjB;CACA,uCAAe,EAAf;CACA,uCAAagD,MAAb,GAAsB,CAAtB;CACD;8DAEsB;CACrB,sCAAY7C,GAAZ,GAAkB,IAAI4C,IAAJ,EAAlB;CACA,yCAAiB,GAAjB;CACA,4BAAI,IAAJ,mBAAyB,KAAKzC,QAAL;CAC1B;8DAcuB;CAAA;CACtB,MAAI2C,IAAI,GAAG,0KAAa9C,GAAb,kFAAkB+C,OAAlB,OAA+B,IAAIH,IAAJ,GAAWG,OAAX,EAA1C;CACA,SAAOD,IAAI,oDAAG,IAAH,8FAAG,uBAAa/C,KAAhB,2DAAG,uBAAoBgD,OAApB,EAAH,CAAJ,IAAwClD,SAA/C;CACD;4EAE8B;CAC7B,SAAQ,iDAAyB,sDAA8BF,GAAxD,GAA+D,IAA/D,IAAuE,CAA9E;CACD;;;;"}